# 数据链路层的功能

## 提供服务

无确认无连接

​	用于误码率较低的（以太网）

有确认无连接

​	误码率较高的（无线通信）

有确认面向连接

​	通信要求高的

## 链路管理

帧定界

​	用首部和尾部确定帧的界限

帧同步

​	让接收的比特流中能区别一个个帧的起止

透明传输

​	可以传输所有数据，数据中有帧定界符也当作普通数据传输的方法

## 流量控制

限制发送方的流量

## 差错控制

位错

帧错

# 组帧

把比特组装成帧的方法，并且实现数据链路层的功能（帧定界，帧同步，透明传输）

需要首部和尾部（分组只需要首部）

## 字符计数法

## 字符填充（用转义符）

## 比特填充

## 违规编码

# 差错控制

## 检错

### 奇偶校验码

### 循环冗余码

## 纠错

### 海明码

k比特信息加上r比特冗余信息，构成k+r的码字必须满足 $2^r\ge k+r+1$

​	纠错d位，需要码矩为 2d+1

​	检错d位，需要码矩为d+1

# 帧的传输

有流量控制、可靠传输功能

## 流量控制

### 停止-等待流量控制

发送方：发一个 等应答 才能再发一个 否则等

接收方：收一个 发送应答信息

### 滑动窗口流量控制

发送方：待发送的帧在发送窗口内，全发送过去。收到一个确认帧就往右滑一位。全发送了收不到，等着。

接收方：待接收的帧在接收窗口内，收到在接收窗口内的帧则往右滑动一位，发送应答。

有序接收方法：接收窗口大小为1

## 可靠传输机制

以下都属于ARQ（自动重传请求）

### 单帧滑动窗口与停止-等待协议

发送方：

​	发送之后等待确认
​		超时重新发送
​		收到确认帧
​			确认帧序号是对的，发送下一个
​			确认帧序号是错的，丢弃确认帧，重新等待

接收方：

​	收到数据帧
​	纠错检错
​		无误
​			比较序号，不符合丢弃（是重复发送）
​			比较序号，符合，发送确认帧

### 多帧滑动窗口与后退N帧协议（GBN）

采用n个比特对帧编号，发送窗口尺寸应满足$1\le W_r\le2^n-1$

>如果总共有8个帧，发送窗口有8个
>
>如果发送全成功了
>
>​	新的发送序号是0~7
>
>如果发送全失败了
>
>​	重新发送序号还是0~7
>
>接收端不能判断是新的还是旧的
>
>所以发送窗口不能为8个

不适合在误码率比较大的地方使用

发送方：

​	可以一直连续发送N个帧，每发一次设置一个计时器
​	如果N个帧之前的一个帧计时器超时，没有收到确认信息
​		重新从这个帧开始发送
​	如果收到确认信息
​		说明前面的都确认了

### 多帧滑动窗口与选择重传（SR）

新窗口与旧窗口没有重叠：$W_R+W_T\le2^n$

接收窗口不该超过发送窗口：$W_R\le2^{(n-1)}$

接收方：

​	接收窗口内的所有数据帧都受到后一并提交主机
​	怀疑帧出错，发送NAK否定帧，要求重传指定帧

# 信道的属性

## 信道的效率（利用率）

发送方：有效的发送数据的时间（发送时延）占整个发送周期时间（发送时延+RTT+接收时延（可省略））的比率

## 信道的吞吐率

信道利用率*发送方的发送速率
# 脚本开发中的痛点

## 测试代码需要上下文。

1.需要数据库

2.需要绑定窗口

一个功能写进一个文件里，热加载。

>需要写个加载器，把上下文交给执行的代码

## 运行中代码难定位

debug模式，输出运行中代码行数

运行频次统计

## 图色识别率

搞一套图片模糊处理的方法

研究tesseract开源OCR API

## 截图做字库慢

一键截图并生成代码工具

一键测试图色工具

自动做字库工具

## 卡点

### 因为游戏卡顿，鼠标操作其实没反应，提前进入了下一步

**前一步操作|图色操作结果检测|后一步操作**

操作结果检测不合格，重新退回前一步操作

>为了便于调试，不要瞎写循环执行的代码

### 游戏突发状况

需要有一个统一处理突发状况的模块

## 多线程读写数据

编写一个多线程贡献数据类，提供持久化功能

# 项目设计

## 脚本文件

单一的功能，就写在一个脚本文件里面

doSomething.py:

```python
if isFinded(findPic('1.bmp',0,0,2000,2000)):
	moveToLClick(x,y)
```

>只关注功能
>
>不用管：
>
>1. 操作哪个窗口
>2. 文件目录
>3. 数据库

## ActionCreater

生成Action

## Store

数据库，根据Action操作数据库

或者返回当前数据

## ScriptLoader

加载脚本，跟脚本提供：

1. 操作哪个窗口的上下文
2. 调试功能，文件修改了就再执行一遍
3. store，有dispath接口(多线程友好的)

## main

1. 创建store
2. 初始化dm（注册组件，注册大漠）
3. 一个窗口一个ScriptLoader

